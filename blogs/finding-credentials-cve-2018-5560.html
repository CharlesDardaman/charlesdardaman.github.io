<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Finding Credentials CVE-2018-5560</title>
    <meta name="description" content="Notes from analyzing Guardzilla GZ521W firmware and uncovering hard-coded AWS S3 credentials (CVE-2018-5560)." />
    <link rel="stylesheet" href="../assets/css/blog.css" />
  </head>
  <body>
    <header class="masthead">
      <div class="masthead__inner">
        <div class="brand">
          <a class="brand__link" href="../index.html">Charles Dardaman</a>
          <p class="brand__tagline">Security engineering, incident response, research.</p>
        </div>
        <nav class="site-nav" aria-label="Primary">
          <ul>
            <li><a href="../index.html#about">About</a></li>
            <li><a href="../index.html#writing">Writing</a></li>
            <li><a href="../index.html#connect">Connect</a></li>
          </ul>
        </nav>
      </div>
    </header>

    <header class="post-header">
      <h1>Finding Credentials CVE-2018-5560</h1>
      <p><time datetime="2018-12-27">December 27, 2018</time></p>
    </header>

    <main>
      <article>
        <h2>Vulnerability</h2>
        <p>
          On 09/29/2018 during the 0DAYALLDAY Research Event, a vulnerability—<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-5560" target="_blank" rel="noopener">CVE-2018-5560</a>—was discovered in the Guardzilla Security Video System (Model GZ521W). The issue sits inside the firmware: hard-coded Amazon Simple Storage Service (S3) credentials bundled with the device.
        </p>
        <p>
          In this post I highlight the portion of the work I focused on to show how straightforward these vulnerabilities are to spot with the right tools. For the full disclosure, read the <a href="https://www.0dayallday.org/guardzilla-video-camera-hard-coded-aws-credentials/" target="_blank" rel="noopener">complete report</a>.
        </p>
        <p>
          After collaborating with Nick McClendon and Andrew Mirghassemi—who provided a firmware dump and binaries—I opened the main executable in IDA Pro and started hunting for interesting strings. Almost immediately I noticed several entries surrounding <code>s3.amazonaws.com</code>.
        </p>
        <figure>
          <img src="../assets/finding-credentials-cve-2018-5560/1.png" alt="IDA Pro screenshot showing AWS-related strings" />
        </figure>
        <p>
          Following the references confirmed my suspicion: the strings were exports named <code>accessKey</code>, <code>secretAccessKey</code>, <code>hostname</code>, and <code>bucket</code>—exactly how AWS S3 credentials are structured.
        </p>
        <figure>
          <img src="../assets/finding-credentials-cve-2018-5560/2.png" alt="Export table revealing hard-coded S3 credential fields" />
        </figure>
        <p>
          Chris later verified that these credentials had unrestricted access to every S3 bucket provisioned for that account.
        </p>

        <h2>Recommendations</h2>
        <ul>
          <li>Stop using the Guardzilla GZ521W camera until a patch is released.</li>
        </ul>

        <h2>Disclosure Timeline</h2>
        <ul>
          <li>Sat, Sep 29, 2018: Issue discovered at 0DayAllDay Research Event.</li>
          <li>Wed, Oct 3, 2018: Issue disclosed to Rapid7 for coordinated disclosure.</li>
          <li>Wed, Oct 24, 2018: Issue disclosed to vendor.</li>
          <li>Thu, Nov 8, 2018: Issue disclosed to CERT/CC as VRF#18-11-NPPXC.</li>
          <li>Fri, Dec 14, 2018: CVE-2018-5560 reserved.</li>
          <li>Thu, Dec 27, 2018: Public disclosure.</li>
        </ul>

        <h2>Researchers</h2>
        <ul>
          <li>Nick McClendon</li>
          <li>Andrew Mirghassemi</li>
          <li>INIT_6</li>
          <li>Chris</li>
        </ul>
      </article>
      <div class="footer">
        <a href="../index.html">← Back to homepage</a>
      </div>
    </main>

    <footer class="site-footer">
      <p>&copy; <span id="current-year"></span> Charles Dardaman</p>
    </footer>

    <script>
      const year = new Date().getFullYear();
      document.getElementById("current-year").textContent = year;
    </script>
  </body>
</html>
