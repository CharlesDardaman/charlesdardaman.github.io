<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Hard-Coded Administrator Password Discovered in OpsRamp Gateway</title>
    <meta name="description" content="Documenting CVE-2020-11543, where OpsRamp Gateway shipped with a shared administrator credential that granted full root access." />
    <link rel="stylesheet" href="../assets/css/blog.css" />
  </head>
  <body>
    <header class="masthead">
      <div class="masthead__inner">
        <div class="brand">
          <a class="brand__link" href="../index.html">Charles Dardaman</a>
          <p class="brand__tagline">Security engineering, incident response, research.</p>
        </div>
        <nav class="site-nav" aria-label="Primary">
          <ul>
            <li><a href="../index.html#about">About</a></li>
            <li><a href="../index.html#writing">Writing</a></li>
            <li><a href="../index.html#connect">Connect</a></li>
          </ul>
        </nav>
      </div>
    </header>

    <header class="post-header">
      <h1>Hard-Coded Administrator Password Discovered in OpsRamp Gateway</h1>
      <p><time datetime="2020-04-06">April 6, 2020</time></p>
    </header>

    <main>
      <article>
        <p><em>This article was originally published at <a href="https://cyberonesecurity.com/offensive-security/hard-coded-administrator-password-discovered-in-opsramp-gateway/" target="_blank" rel="noopener">https://cyberonesecurity.com/offensive-security/hard-coded-administrator-password-discovered-in-opsramp-gateway/</a> and is duplicated here for posterity.</em></p>

        <p><strong>Version Tested:<br /></strong>
        3.0.0</p>

        <p><strong>Product:<br /></strong>
        <a href="https://www.opsramp.com/" target="_blank" rel="noopener">https://www.opsramp.com/</a></p>

        <p><strong>CVE Numbers:<br /></strong>
        CVE-2020-11543</p>

        <p><strong>CVSS Score:<br /></strong>
        10.0 AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H</p>

        <p><strong>CWE:<br /></strong>
        CWE-798: Use of Hard-coded Credentials</p>

        <p><strong>OWASP:<br /></strong>
        <a href="https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password" target="_blank" rel="noopener">https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password</a></p>

        <p><strong>Summary:<br /></strong>
        During a recent penetration test, CyberOne’s researchers discovered that OpsRamp Gateway has an administrative account named <em>vadmin</em> that allows root SSH access to the server. This account was unknown to clients unless requested through a support process. At that time the vendor states they would provide the account to the client and request that they change the password.</p>

        <p>Prior to the patch, this password was not unique to all clients, only to those who requested access to the account and changed the password. Cyber One is unaware of the number of clients that may have requested access and changed the password.</p>

        <p><strong>Technical Details:<br /></strong>
        After installing the OpsRamp Gateway server, a script called <code>kick-start.sh</code> runs, which sets up multiple user accounts and hardcodes their passwords by setting the pre-hashed passwords.</p>

        <figure>
          <img src="../images/61dcfcf2ab05ef7d62bdf752_1-2-1536x776-1-1024x517.png" alt="Excerpt of kick-start.sh showing preset password hashes" />
        </figure>

        <p>Our team was able to crack the hash for the <em>vadmin</em>, which can be used to SSH into the server with the password <strong>9vt@f3Vt</strong>. Additionally, the account has the sudo permissions ALL, allowing us to easily escalate to root with <code>sudo -i</code>.</p>

        <figure>
          <img src="../images/61dcfcf2c82e3b9781f67a3e_figure-2.png" alt="Terminal screenshot demonstrating sudo privileges for vadmin" />
        </figure>

        <p>We then proceeded to log into client servers in production as root proving that the hashes are not unique to the install.</p>

        <p><strong>Timeline:<br /></strong>
        10/24/2019 – Vulnerability found<br />
        01/20/2020 – CyberOne was informed that the vendor patched the finding<br />
        03/26/2020 – Ensured that clients were patched<br />
        03/26/2020 – CVE requested<br />
        04/07/2020 – Released vulnerability disclosure</p>

        <p><strong>Credit:<br /></strong>
        Discovered by Charles Dardaman, Senior Adversarial Engineer at CyberOne</p>
      </article>
      <div class="footer">
        <a href="../index.html">← Back to homepage</a>
      </div>
    </main>

    <footer class="site-footer">
      <p>&copy; <span id="current-year"></span> Charles Dardaman</p>
    </footer>

    <script>
      const year = new Date().getFullYear();
      document.getElementById("current-year").textContent = year;
    </script>
  </body>
</html>
